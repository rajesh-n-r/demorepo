
query 8:    In Hive create a Targetdb 


hive> show databases;
OK
default
source_credcarddb
Time taken: 0.022 seconds, Fetched: 2 row(s)
hive> create database targetdb;
OK
Time taken: 0.032 seconds
hive> ;
hive> show databases;
OK
default
source_credcarddb
targetdb
Time taken: 0.018 seconds, Fetched: 3 row(s)
hive> 

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

query 9:    Goto Spark and process the data as per functional requirement

requirement 1:  Create Externa table in parquet format For each output from 1 -2  Table names. CreditCard wise - Year – wise Month wise .  Summarized  output


hive> CREATE EXTERNAL TABLE IF NOT EXISTS TARGETDB.TRAN_CREDITCARD(TRAN_ID INT,CUST_ID BIGINT) PARTITIONED BY (TRAN_DATE BIGINT) ROW
    >  FORMAT DELIMITED FIELDS TERMINATED BY ',' STORED AS parquet location '/user/hduser/credcarddb/outputdir/Year_Month_Partition/';
OK
Time taken: 0.011 seconds
hive> INSERT OVERWRITE TABLE TARGETDB.TRAN_CREDITCARD PARTITION (TRAN_DATE) SELECT TRAN_ID,CUST_ID,TRAN_DATE FROM CREDITCARD;
Query ID = rajesh_20220208171241_f406e070-eb82-41be-9a9b-7ed15c82a870
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1644250992493_0001, Tracking URL = http://rajesh:8088/proxy/application_1644250992493_0001/
Kill Command = /home/rajesh/hadoop-2.10.1/bin/hadoop job  -kill job_1644250992493_0001
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2022-02-08 17:12:47,472 Stage-1 map = 0%,  reduce = 0%
2022-02-08 17:12:53,669 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 2.09 sec
MapReduce Total cumulative CPU time: 2 seconds 90 msec
Ended Job = job_1644250992493_0001
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://localhost:9000/user/hduser/credcarddb/outputdir/Year_Month_Partition/.hive-staging_hive_2022-02-08_17-12-41_519_7953707695018248342-1/-ext-10000
Loading data to table targetdb.tran_creditcard partition (tran_date=null)
	 Time taken for load dynamic partitions : 98
	Loading partition {tran_date=__HIVE_DEFAULT_PARTITION__}
	 Time taken for adding to write entity : 1
Partition targetdb.tran_creditcard{tran_date=__HIVE_DEFAULT_PARTITION__} stats: [numFiles=1, numRows=22, totalSize=341, rawDataSize=44]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 2.09 sec   HDFS Read: 6170 HDFS Write: 458 SUCCESS
Total MapReduce CPU Time Spent: 2 seconds 90 msec
OK
Time taken: 13.52 seconds
hive> SELECT * FROM TARGETDB.TRAN_CREDITCARD;
OK
SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
2018-11-28	3562001602	6334878173213670	567936602
2018-11-28	3562001602	6334878173213670	567936602
2018-12-08	3562001602	6334878173213670	567936602
2018-12-15	3562001602	6334878173213670	567936602
2018-12-24	3562001602	6334878173213670	567936602
2019-01-01	3562001602	6334878173213670	567936602
2019-01-11	3562001602	6334878173213670	567936602
2019-01-24	3562001602	6334878173213670	567936602
2019-01-24	3562001602	6334878173213670	567936602
2019-03-01	3562001602	6334878173213670	567936602
2018-12-08	3562001602	6334878173213670	567936602
2019-03-01	3562001602	6334878173213670	567936602
2018-12-15	3562001602	6334878173213670	567936602
2016-01-12	3562001603	3567523223820780	190445473
2017-08-01	3562001603	3567523223820780	190445473
2017-08-01	3562001603	3567523223820780	190445473
2018-04-05	3562001603	3567523223820780	190445473
2018-04-10	3562001603	3567523223820780	190445473
2018-04-11	3562001603	3567523223820780	190445473
2018-04-24	3562001603	3567523223820780	190445473
2016-01-27	3562001604	3039905356295530	143032108
2017-05-12	3562001604	3039905356295530	143032108
2017-05-25	3562001604	3039905356295530	143032108
2018-12-02	3562001606	3578070062995380	280264513
2018-12-04	3562001606	3578070062995380	280264513
2018-12-14	3562001606	3578070062995380	280264513
2018-12-21	3562001606	3578070062995380	280264513
2016-02-05	3562001607	5403648817321420	195223654
2016-02-05	3562001607	5403648817321420	195223654
2016-03-15	3562001607	5403648817321420	195223654
2017-06-17	3562001607	5403648817321420	195223654
2017-07-04	3562001607	5403648817321420	195223654
2017-08-18	3562001607	5403648817321420	195223654
2018-07-03	3562001607	5403648817321420	195223654
2018-08-02	3562001607	5403648817321420	195223654
2016-03-16	3562001607	5403648817321420	195223654
2017-04-29	3562001607	5403648817321420	195223654
2017-04-29	3562001607	5403648817321420	195223654
2017-06-17	3562001607	5403648817321420	195223654
2017-07-04	3562001607	5403648817321420	195223654
2017-08-18	3562001607	5403648817321420	195223654
2018-07-03	3562001607	5403648817321420	195223654
2018-08-02	3562001607	5403648817321420	195223654
2016-02-05	3562001608	3547496963061990	531442970
2016-02-17	3562001608	3547496963061990	531442970
2016-03-31	3562001608	3547496963061990	531442970
2017-06-09	3562001608	3547496963061990	531442970
2017-06-09	3562001608	3547496963061990	531442970
2018-12-04	3562001611	4936290378811880	653470680
2018-12-08	3562001611	4936290378811880	653470680
2018-12-08	3562001611	4936290378811880	653470680
2018-12-10	3562001611	4936290378811880	653470680
2018-12-12	3562001611	4936290378811880	653470680
2018-12-15	3562001611	4936290378811880	653470680
2018-12-17	3562001611	4936290378811880	653470680
2018-12-19	3562001611	4936290378811880	653470680
2018-12-21	3562001611	4936290378811880	653470680
2018-12-28	3562001611	4936290378811880	653470680
2016-02-10	3562001612	3531017574361360	355714929
2017-06-15	3562001612	3531017574361360	355714929
2017-06-17	3562001612	3531017574361360	355714929
2016-02-03	3562001613	3588589058006900	763905687
2016-03-05	3562001615	3566727575950610	398859724
2017-04-10	3562001615	3566727575950610	398859724
2018-03-03	3562001615	3566727575950610	398859724
2018-03-30	3562001615	3566727575950610	398859724
2018-11-25	3562001617	3058775791217550	496377931
2018-11-29	3562001617	3058775791217550	496377931
2018-11-30	3562001617	3058775791217550	496377931
2019-02-18	3562001617	3058775791217550	496377931
2019-02-24	3562001617	3058775791217550	496377931
2017-07-03	3562001621	3537914201882630	462741915
2017-07-03	3562001621	3537914201882630	462741915
2017-07-30	3562001621	3537914201882630	462741915
2018-09-05	3562001621	3537914201882630	462741915
2018-09-07	3562001621	3537914201882630	462741915
2018-09-10	3562001621	3537914201882630	462741915
2018-09-17	3562001621	3537914201882630	462741915
2018-09-17	3562001621	3537914201882630	462741915
2018-09-19	3562001621	3537914201882630	462741915
2018-09-20	3562001621	3537914201882630	462741915
2018-09-22	3562001621	3537914201882630	462741915
2018-09-27	3562001621	3537914201882630	462741915
2016-02-19	3562001630	6378610833616780	522026991
2017-04-14	3562001630	6378610833616780	522026991
2016-02-19	3562001630	6378610833616780	522026991
2017-04-15	3562001630	6378610833616780	522026991
2019-02-08	3562001631	3537861601381620	417953628
2019-02-21	3562001631	3537861601381620	417953628
2016-03-29	3562001635	5602257512986730	742724564
2017-05-17	3562001635	5602257512986730	742724564
2017-05-19	3562001635	5602257512986730	742724564
2016-03-29	3562001635	5602257512986730	742724564
2017-06-17	3562001635	5602257512986730	742724564
2017-06-19	3562001635	5602257512986730	742724564
2018-03-22	3562001638	5210169439885370	610816990
2018-07-10	3562001638	5210169439885370	610816990
2018-07-30	3562001638	5210169439885370	610816990
2017-04-01	3562001638	5210169439885370	610816990
2017-04-01	3562001638	5210169439885370	610816990
2018-03-22	3562001638	5210169439885370	610816990
2018-07-10	3562001638	5210169439885370	610816990
2018-07-30	3562001638	5210169439885370	610816990
2018-12-27	3562001649	5127419432105430	531517681
2018-12-30	3562001649	5127419432105430	531517681
2019-01-02	3562001649	5127419432105430	531517681
2019-02-12	3562001649	5127419432105430	531517681
2019-02-22	3562001649	5127419432105430	531517681
2018-12-30	3562001649	5127419432105430	531517681
2018-12-27	3562001649	5127419432105430	531517681
2019-01-03	3562001649	5127419432105430	531517681
2019-02-12	3562001649	5127419432105430	531517681
2019-02-23	3562001649	5127419432105430	531517681
2018-04-12	3562001652	3553250558494440	185955202
2018-06-01	3562001652	3553250558494440	185955202
2018-08-11	3562001652	3553250558494440	185955202
2018-08-25	3562001652	3553250558494440	185955202
2018-08-30	3562001652	3553250558494440	185955202
2018-08-06	3562001652	3553250558494440	185955202
2018-08-24	3562001652	3553250558494440	185955202
2018-10-02	3562001652	3553250558494440	185955202
2018-10-12	3562001652	3553250558494440	185955202
2018-10-22	3562001652	3553250558494440	185955202
2018-12-02	3562001662	2017763113611190	651396269
2018-12-01	3562001662	2017763113611190	651396269
2018-12-06	3562001662	2017763113611190	651396269
2018-12-09	3562001662	2017763113611190	651396269
2018-12-12	3562001662	2017763113611190	651396269
2018-12-23	3562001662	2017763113611190	651396269
2020-04-13	3562001662	2017763113611190	651396269
2020-04-15	3562001662	2017763113611190	651396269
2020-04-23	3562001662	2017763113611190	651396269
2020-05-10	3562001662	2017763113611190	651396269
2020-05-23	3562001662	2017763113611190	651396269
2017-09-05	3562001664	6334792030406340	639326651
2018-02-22	3562001664	6334792030406340	639326651
2018-07-07	3562001664	6334792030406340	639326651
2017-09-05	3562001664	6334792030406340	639326651
2018-02-22	3562001664	6334792030406340	639326651
2018-07-07	3562001664	6334792030406340	639326651
2017-06-12	3562001674	3549138667705450	828832569
2017-06-17	3562001674	3549138667705450	854984549
2017-08-28	3562001674	3549138667705450	854984549
2018-05-18	3562001674	3549138667705450	854984549
2018-07-21	3562001674	3549138667705450	828832569
2018-07-23	3562001674	3549138667705450	828832569
2018-08-28	3562001674	3549138667705450	854984549
2018-09-01	3562001674	3549138667705450	828832569
2018-09-12	3562001674	3549138667705450	854984549
2018-09-23	3562001674	3549138667705450	828832569
2018-09-26	3562001674	3549138667705450	854984549
2018-09-28	3562001674	3549138667705450	854984549
2018-09-30	3562001674	3549138667705450	828832569
2018-09-28	3562001674	3549138667705450	854984549
2017-06-17	3562001674	3549138667705450	854984549
2017-08-28	3562001674	3549138667705450	854984549
2018-05-18	3562001674	3549138667705450	854984549
2018-08-28	3562001674	3549138667705450	854984549
2018-09-12	3562001674	3549138667705450	854984549
2018-09-26	3562001674	3549138667705450	854984549
2019-01-09	3562001678	3041940220450330	580262327
2019-01-12	3562001678	3041940220450330	580262327
2019-01-12	3562001678	3041940220450330	580262327
2019-01-13	3562001678	3041940220450330	580262327
2019-01-18	3562001678	3041940220450330	580262327
2018-10-03	3562001682	6304715204316940	469721617
2018-05-05	3562001682	6304715204316940	469721617
2018-09-01	3562001682	6304715204316940	469721617
2018-08-29	3562001682	6304715204316940	469721617
2018-09-12	3562001682	6304715204316940	469721617
2018-10-03	3562001682	6304715204316940	469721617
2018-05-05	3562001682	6304715204316940	469721617
2018-08-29	3562001682	6304715204316940	469721617
2018-09-02	3562001682	6304715204316940	469721617
2018-09-12	3562001682	6304715204316940	469721617
2018-06-01	3562001688	4607915147472950	727103869
2018-06-10	3562001688	4607915147472950	727103869
2018-06-23	3562001688	4607915147472950	727103869
2018-08-15	3562001692	5602236760338580	346586073
2018-09-12	3562001692	5602236760338580	346586073
2018-10-11	3562001692	5602236760338580	346586073
2018-10-27	3562001692	5602236760338580	346586073
2019-11-04	3562001692	5602236760338580	346586073
2018-11-24	3562001692	5602236760338580	346586073
2018-02-03	3562001696	3583849494251710	751883259
2018-06-02	3562001696	3583849494251710	751883259
2018-06-20	3562001696	3583849494251710	751883259
2018-10-04	3562001696	3583849494251710	751883259
2018-10-20	3562001696	3583849494251710	751883259
2018-10-23	3562001696	3583849494251710	751883259
2018-11-03	3562001696	3583849494251710	751883259
2018-11-15	3562001696	3583849494251710	751883259
2018-11-21	3562001696	3583849494251710	751883259
2018-11-25	3562001696	3583849494251710	751883259
2018-08-13	3562001699	2014268557886530	342068735
2018-03-07	3562001699	2014268557886530	342068735
2018-03-13	3562001699	2014268557886530	342068735
2018-03-20	3562001699	2014268557886530	342068735
2018-03-25	3562001699	2014268557886530	342068735
2018-03-21	3562001699	2014268557886530	342068735
2018-03-31	3562001699	2014268557886530	342068735
2018-08-10	3562001699	2014268557886530	342068735
2018-08-19	3562001699	2014268557886530	342068735
2018-08-23	3562001699	2014268557886530	342068735
Time taken: 0.091 seconds, Fetched: 202 row(s)


 -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

requirement 2 : Generate monthly bill for a credit card number – Year & Month detailed

hive> CREATE TEMPORARY TABLE monthly_bill(cust_id bigint,cust_f_name varchar(40),cust_m_name varchar (40), cust_l_name varchar(40),cust_cc_no bigint,
card_type varchar(40),tran_year int,tran_month varchar(50),bill int,remark string) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' STORED AS TEXTFILE; 
OK
Time taken: 0.06 seconds
hive> load data local inpath '/home/rajesh/source_local/Customer.csv' into table monthly_bill;
Loading data to table source_credcarddb.monthly_bill
Table source_credcarddb.monthly_bill stats: [numFiles=1, totalSize=9482]
OK
Time taken: 0.06 seconds
hive> select * from monthly_bill;
OK
NULL	CUST_F_NAME	CUST_M_NAME	CUST_L_NAME	NULL	CARD_TYPE	NULL	CARD_END_DATE	NULL	CUST_STREET
3562001602	Chrissie		Rayner	6334878173213670	amex	500000	9/12/2017	567936602	Noble Embers Ridge
3562001603	Titus		Paolozzi	3567523223820780	visa	50000	6/17/2024	190445473	Blue Pioneer Bend
3562001604	Jethro	Byrom	Winear	3039905356295530	amex	500000	7/16/2021	143032108	Little Common
3562001606	Lura		Flye	3578070062995380	visa	50000	10/20/2018	280264513	Sleepy Quail Promenade
3562001607	Merrill		Ratcliff	5403648817321420	master	100000	3/3/2017	195223654	High Concession
3562001608	Venita	Lennard	Rutgers	3547496963061990	visa	50000	5/24/2024	531442970	Foggy Forest Plaza
3562001610	Orbadiah		Royson	3051418309044220	amex	500000	4/1/2023	835384343	Harvest Beacon Plaza
3562001611	Merle		McGenn	4936290378811880	master	100000	4/23/2025	653470680	Stony Woods
3562001612	Fidel		Windas	3531017574361360	visa	50000	7/9/2019	355714929	Jagged Embers By-pass
3562001613	Beatrice		Feedome	3588589058006900	visa	50000	3/18/2019	763905687	Iron Oak Gardens
3562001614	Asia		Trudgion	5602256302089870	amex	500000	1/25/2024	533779130	Hazy Pony Square
3562001615	Nessa		Brisse	3566727575950610	visa	50000	2/12/2027	398859724	Burning Glen
3562001616	Cristine	Vittorio	Braxay	2017260974760290	amex	50000	6/11/2021	585616059	Iron Port
3562001617	Tucky		Sabbatier	3058775791217550	amex	500000	7/18/2023	496377931	Noble Pike
3562001621	Peg		Welbrock	3537914201882630	visa	50000	8/16/2017	462741915	Old Willow Mall
3562001622	Amity		Birkenshaw	3746221893451670	amex	500000	10/24/2017	527168982	Heather Plaza
3562001623	Marylynne	Sheff	Peddel	4913946420798260	visa	50000	1/3/2022	726028398	Noble Embers Ridge
3562001624	Vladamir	Augy	Hehl	6763887925070990	master	100000	9/4/2025	854984549	Blue Pioneer Bend
3562001626	Giacomo		Clifton	3746227754890490	amex	500000	9/6/2024	416699493	Sleepy Quail Promenade
3562001627	Dalila		Weatherhead	3539018736993780	visa	50000	6/5/2024	756695602	Little Common
3562001629	Sherlock	Vince	Woolliams	5602225917136840	amex	500000	2/12/2021	381425374	Heather Plaza
3562001630	Elladine	Kenneth	Dealy	6378610833616780	master	100000	1/4/2020	522026991	Jagged Embers By-pass
3562001631	Marlow	Deane	Seleway	3537861601381620	visa	50000	11/19/2016	417953628	Noble Embers Ridge
3562001634	Haywood	Cesare	Gernier	3555072384085640	visa	50000	11/17/2021	324748675	Blue Pioneer Bend
3562001635	Sampson		Genge	5602257512986730	amex	500000	7/11/2022	742724564	Hazy Pony Square
3562001636	Iggy		Wardale	3584827256597080	visa	50000	11/23/2024	629172934	Heather Plaza
3562001637	Lorain		Crone	4913586748929930	visa	50000	10/7/2021	316626688	Little Common
3562001638	Denny		Hehir	5210169439885370	master	100000	1/5/2017	610816990	Sleepy Quail Promenade
3562001643	Edmund		Trigg	5468084768591910	master	100000	11/6/2024	646192779	Red Treasure Bay
3562001649	Fawnia		Swale	5127419432105430	master	100000	3/21/2025	531517681	Heather Plaza
3562001650	Cristine		Juden	6334827235490350	amex	500000	10/19/2025	551848770	Heather Plaza
3562001651	Freeman	Bartlet	Ledeker	3574831034580740	visa	50000	4/18/2027	403637146	Sleepy Quail Promenade
3562001652	Gina		Massimi	3553250558494440	visa	50000	5/27/2019	185955202	Noble Embers Ridge
3562001654	Amil	Curr	Fawbert	5010120208028190	master	100000	1/14/2023	490994326	Blue Pioneer Bend
3562001661	Clarinda		Scoone	4936566808390050	master	100000	8/11/2026	636563744	Jagged Embers By-pass
3562001662	Reta		Nairy	2017763113611190	amex	500000	5/11/2018	651396269	Quaking Street
3562001664	Nessy		Royal	6334792030406340	amex	500000	5/1/2023	639326651	Blue Pioneer Bend
3562001667	Devlen		Pietraszek	3576170925662380	visa	50000	11/7/2023	132925451	Little Common
3562001674	Rhoda	Arlin	Biddles	3549138667705450	visa	50000	5/22/2020	828832569	Foggy Forest Plaza
3562001675	Florenza	Marwin	Tortice	3576661367312800	visa	50000	3/21/2021	247313110	Noble Embers Ridge
3562001676	Trumaine	Arel	Lukock	4905195125036260	master	100000	10/6/2024	138775149	Old Willow Mall
3562001678	Bogart	Raimund	Summersby	3041940220450330	amex	500000	5/25/2024	580262327	Hazy Pony Square
3562001679	Sawyer		Ismail	3547026896168710	visa	50000	12/22/2026	519314802	Sleepy Quail Promenade
3562001680	Nelie	Rollin	Camelin	5602250664479540	amex	500000	7/23/2023	725510273	Burning Glen
3562001681	Jacklin		Stango	6771126200690550	master	100000	1/22/2022	111143799	High Concession
3562001682	Ilario		Hadfield	6304715204316940	master	100000	4/7/2017	469721617	Heather Plaza
3562001683	Ruperto	Leupold	Martinez	3583060400927120	visa	50000	5/13/2021	759211565	Quaking Street
3562001687	Meredeth		Blaycock	6334071935110170	amex	500000	3/18/2018	342743043	Little Common
3562001688	Torrance		Scrowby	4607915147472950	visa	50000	3/7/2018	727103869	Harvest Beacon Plaza
3562001689	Berton	Ryan	Mc Pake	5371063911268820	master	100000	3/5/2017	338877893	Hazy Butterfly Circle
3562001690	Sigismondo		Clever	3553276103969740	visa	50000	4/6/2027	693722843	High Concession
3562001691	Bidget	Curcio	Chestnutt	5602255813010240	amex	500000	8/27/2023	310164096	Sleepy Quail Promenade
3562001692	Layne	Isacco	Phelips	5602236760338580	amex	500000	12/4/2018	346586073	Old Willow Mall
3562001693	Zilvia	Raynard	Fox	5602242963853220	amex	500000	9/25/2027	224472153	Jagged Embers By-pass
3562001695	Derron	Gothart	Kitchinghan	4913225109356710	visa	50000	10/22/2019	893685782	Burning Glen
3562001696	Ray		Dilliway	3583849494251710	visa	50000	7/5/2027	751883259	Heather Plaza
3562001697	Ebenezer	Corty	Demanche	6759542041496280	master	100000	4/30/2021	150789497	Harvest Beacon Plaza
3562001698	Tillie	Corty	Denisot	3550166575967910	visa	50000	4/23/2025	802751526	Quaking Street
3562001699	Brig		Tompkiss	2014268557886530	amex	500000	2/28/2022	342068735	Hazy Pony Square
3562001700	Martha		Harnes	3557727107117620	visa	50000	4/29/2026	327478784	Noble Embers Ridge
Time taken: 0.078 seconds, Fetched: 61 row(s)
hive> 




hive> create external table targetdb.monthly_bill(cust_id bigint,cust_f_name varchar(40),cust_m_name varchar (40), cust_l_name varchar(40),cust_cc_no bigint) PARTITIONED BY (card_type varchar(50)) row format delimited fields terminated by ',' lines terminated by '\n' stored as parquet location '/user/hduser/credcarddb/outputdir/Monthly_Bill/';
OK
Time taken: 0.069 seconds
hive> INSERT OVERWRITE TABLE TARGETDB.MONTHLY_BILL PARTITION (card_type) SELECT CUST_ID,cust_f_name,cust_m_name,cust_l_name,cust_cc_no,card_type FROM CUSTOMER;
Query ID = rajesh_20220208230754_0e3b5cc8-a916-46a8-a997-444b9a664874
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1644250992493_0002, Tracking URL = http://rajesh:8088/proxy/application_1644250992493_0002/
Kill Command = /home/rajesh/hadoop-2.10.1/bin/hadoop job  -kill job_1644250992493_0002
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2022-02-08 23:08:00,314 Stage-1 map = 0%,  reduce = 0%
2022-02-08 23:08:07,542 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 3.62 sec
MapReduce Total cumulative CPU time: 3 seconds 620 msec
Ended Job = job_1644250992493_0002
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://localhost:9000/user/hduser/credcarddb/outputdir/Monthly_Bill/.hive-staging_hive_2022-02-08_23-07-54_186_71589276236398720-1/-ext-10000
Loading data to table targetdb.monthly_bill partition (card_type=null)
	 Time taken for load dynamic partitions : 249
	Loading partition {card_type=visa}
	Loading partition {card_type=amex}
	Loading partition {card_type=master}
	 Time taken for adding to write entity : 0
Partition targetdb.monthly_bill{card_type=amex} stats: [numFiles=1, numRows=20, totalSize=1348, rawDataSize=100]
Partition targetdb.monthly_bill{card_type=master} stats: [numFiles=1, numRows=14, totalSize=1107, rawDataSize=70]
Partition targetdb.monthly_bill{card_type=visa} stats: [numFiles=1, numRows=26, totalSize=1535, rawDataSize=130]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 3.62 sec   HDFS Read: 15889 HDFS Write: 4196 SUCCESS
Total MapReduce CPU Time Spent: 3 seconds 620 msec
OK
Time taken: 15.018 seconds
hive> select * from targetdb.monthly_bill;
OK
NULL    Chrissie                Rayner  6334878173213670        amex
NULL	Jethro	Byrom	Winear	3039905356295530	amex
NULL	Orbadiah		Royson	3051418309044220	amex
NULL	Asia		Trudgion	5602256302089870	amex
NULL	Cristine	Vittorio	Braxay	2017260974760290	amex
NULL	Tucky		Sabbatier	3058775791217550	amex
NULL	Amity		Birkenshaw	3746221893451670	amex
NULL	Giacomo		Clifton	3746227754890490	amex
NULL	Sherlock	Vince	Woolliams	5602225917136840	amex
NULL	Sampson		Genge	5602257512986730	amex
NULL	Cristine		Juden	6334827235490350	amex
NULL	Reta		Nairy	2017763113611190	amex
NULL	Nessy		Royal	6334792030406340	amex
NULL	Bogart	Raimund	Summersby	3041940220450330	amex
NULL	Nelie	Rollin	Camelin	5602250664479540	amex
NULL	Meredeth		Blaycock	6334071935110170	amex
NULL	Bidget	Curcio	Chestnutt	5602255813010240	amex
NULL	Layne	Isacco	Phelips	5602236760338580	amex
NULL	Zilvia	Raynard	Fox	5602242963853220	amex
NULL	Brig		Tompkiss	2014268557886530	amex
NULL	Merrill		Ratcliff	5403648817321420	master
NULL	Merle		McGenn	4936290378811880	master
NULL	Vladamir	Augy	Hehl	6763887925070990	master
NULL	Elladine	Kenneth	Dealy	6378610833616780	master
NULL	Denny		Hehir	5210169439885370	master
NULL	Edmund		Trigg	5468084768591910	master
NULL	Fawnia		Swale	5127419432105430	master
NULL	Amil	Curr	Fawbert	5010120208028190	master
NULL	Clarinda		Scoone	4936566808390050	master
NULL	Trumaine	Arel	Lukock	4905195125036260	master
NULL	Jacklin		Stango	6771126200690550	master
NULL	Ilario		Hadfield	6304715204316940	master
NULL	Berton	Ryan	Mc Pake	5371063911268820	master
NULL	Ebenezer	Corty	Demanche	6759542041496280	master
NULL	Titus		Paolozzi	3567523223820780	visa
NULL	Lura		Flye	3578070062995380	visa
NULL	Venita	Lennard	Rutgers	3547496963061990	visa
NULL	Fidel		Windas	3531017574361360	visa
NULL	Beatrice		Feedome	3588589058006900	visa
NULL	Nessa		Brisse	3566727575950610	visa
NULL	Peg		Welbrock	3537914201882630	visa
NULL	Marylynne	Sheff	Peddel	4913946420798260	visa
NULL	Dalila		Weatherhead	3539018736993780	visa
NULL	Marlow	Deane	Seleway	3537861601381620	visa
NULL	Haywood	Cesare	Gernier	3555072384085640	visa
NULL	Iggy		Wardale	3584827256597080	visa
NULL	Lorain		Crone	4913586748929930	visa
NULL	Freeman	Bartlet	Ledeker	3574831034580740	visa
NULL	Gina		Massimi	3553250558494440	visa
NULL	Devlen		Pietraszek	3576170925662380	visa
NULL	Rhoda	Arlin	Biddles	3549138667705450	visa
NULL	Florenza	Marwin	Tortice	3576661367312800	visa
NULL	Sawyer		Ismail	3547026896168710	visa
NULL	Ruperto	Leupold	Martinez	3583060400927120	visa
NULL	Torrance		Scrowby	4607915147472950	visa
NULL	Sigismondo		Clever	3553276103969740	visa
NULL	Derron	Gothart	Kitchinghan	4913225109356710	visa
NULL	Ray		Dilliway	3583849494251710	visa
NULL	Tillie	Corty	Denisot	3550166575967910	visa
NULL	Martha		Harnes	3557727107117620	visa
Time taken: 0.166 seconds, Fetched: 60 row(s)


--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

requirement 2:  Find the customer exceeding card limit – monthly.